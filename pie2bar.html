<!DOCTYPE html>
<html>
    <head>
        <title>D3.js Charts</title>
	<script src="./d3.min.js"></script>
	<body>
   </body>

   <script type="text/javascript">
	    var width = 960,
	    height = 500;

	    var barheight = 80,
	    	barwidth = 30,
	    	base = [width/2 , height/2];

	    var center = [width/2,height/2],
	    	innerRadius = 50,
	    	outerRadius = innerRadius + barwidth,
	    	startAngle = 0,
	    	endAngle = Math.PI / 2;

	    var data = [500,750,120,800];

	    var color = ["red","blue","yellow","green"];
	    var	p = d3.layout.pie(),
	    	pd = p(data),
	    	k = pd.map(function(d){return d3.scale.linear().domain([0,+d.value]).range([d.startAngle,d.endAngle]);});

/*	[0,i,barwidth,i]*/

/*	[innerRadius * sin(theta), innerRadius * cos(theta) , outerRadius * sin(theta), outerRadius * cos(theta)]  */

		var svg = d3.select("body").append("svg")
		    .attr("width", width)
		    .attr("height", height)
		  .append("g")
		  .attr("stroke","green")
		  .attr("transform", "translate(" + width / 2 + "," + height / 2 + ")");

		var bar = svg.selectAll(".bar")
				.data(data)
			   .enter()
			    .append("g")
			   	.attr("class","bar")
			   	.attr('transform',function(d,i){return 'translate(' + (50 * i) + ',' + 0 + ')';})
			   	.attr("stroke",function(d,i){return color[i];})
			   	.attr("ix",function(d,i){return i;});

		var lines = bar.selectAll("line")
				.data(function(d){return d3.range(d);})
			   .enter()
			    .append("line")
			    .attr("x1",function(d){return 0;})
			    .attr("y1",function(d){return -d;})
			    .attr("x2",function(d){return barwidth;})
			    .attr("y2",function(d){return -d;});

			d3.selectAll(".bar")
				.each(toPie);



	function toPie(){
		var ki = +this.getAttribute("ix");
	    d3.select(this).selectAll("line")
		    .transition()
		    .delay(300)
		    .duration(500)
		    .attr("x1",function(d){return innerRadius * Math.sin(k[ki](d)) - 50 * ki;})
		    .attr("y1",function(d){return innerRadius * Math.cos(k[ki](d));})
		    .attr("x2",function(d){return outerRadius * Math.sin(k[ki](d)) - 50 * ki;})
		    .attr("y2",function(d){return outerRadius * Math.cos(k[ki](d));});
	}

	function toBar(){
		var ki = +this.getAttribute("ix");
	    d3.select(this).selectAll("line")
		    .transition()
		    .delay(300)
		    .duration(500)
			.attr("x1",function(d){return 0;})
		    .attr("y1",function(d){return -d;})
		    .attr("x2",function(d){return barwidth;})
		    .attr("y2",function(d){return -d;});

	}



   </script>
	</head>
</html>